<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with NetCoupler • NetCoupler</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with NetCoupler">
<meta property="og:description" content="NetCoupler">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NetCoupler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.4.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/NetCoupler.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/description.html">Implementation details of NetCoupler</a>
    </li>
    <li>
      <a href="../articles/examples.html">Examples of using NetCoupler with different models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/NetCoupler/NetCoupler/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="NetCoupler_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with NetCoupler</h1>
                        <h4 data-toc-skip class="author">Clemens Wittenbecher</h4>
                        <h4 data-toc-skip class="author">Luke Johnston</h4>
            
            <h4 data-toc-skip class="date">2022-02-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/NetCoupler/NetCoupler/blob/HEAD/vignettes/NetCoupler.Rmd" class="external-link"><code>vignettes/NetCoupler.Rmd</code></a></small>
      <div class="hidden name"><code>NetCoupler.Rmd</code></div>

    </div>

    
    
<p><img src="https://img.shields.io/badge/document%20status-rough%20draft-red?style=flat-square"></p>
<p>The goal of NetCoupler is to estimate causal links between a set of -omic (e.g. metabolomics, lipidomics) or other high-dimensional data and an external variable, such as a disease outcome, an exposure, or both. The NetCoupler-algorithm, initially formulated during Clemens’ PhD thesis <span class="citation">(Wittenbecher 2017)</span>, links a conditional dependency network with an external variable (i.e. an outcome or exposure) to identify network-independent associations between the network variables and the external variable, classified as direct effects.</p>
<p>A typical use case we have in mind would be if a researcher might be interested in exploring potential pathways that exist between a health exposure like red meat consumption, its impact on the metabolic profile, and the subsequent impact on an outcome like type 2 diabetes incidence.</p>
<p>The input for NetCoupler includes:</p>
<ol style="list-style-type: decimal">
<li>Standardized metabolic or other high-dimensional data.</li>
<li>Exposure or outcome data.</li>
<li>Network estimating method (default is the PC algorithm <span class="citation">(Colombo and Maathuis 2014)</span> from the <a href="https://CRAN.R-project.org/package=pcalg" class="external-link">pcalg</a> package).</li>
<li>Modeling method (e.g. linear regression with <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>), including confounders to adjust for.</li>
</ol>
<!-- TODO: Add figure demonstrating NetCoupler --><p>The final output is the modeling results along with the results from NetCoupler’s classification. Results can then be displayed as a joint network model in graphical format.</p>
<div class="section level2">
<h2 id="overall-framework">Overall framework<a class="anchor" aria-label="anchor" href="#overall-framework"></a>
</h2>
<p>NetCoupler has several frameworks in mind:</p>
<ul>
<li>Works with <a href="https://magrittr.tidyverse.org/" class="external-link">magrittr</a> <code>%&gt;%</code> or base R <code>|&gt;</code> operator.</li>
<li>Works with <a href="https://tidyselect.r-lib.org/" class="external-link">tidyselect</a> helpers (e.g. <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains()</a></code>).</li>
<li>Is auto-complete friendly (e.g. start function names with <code>nc_</code>).</li>
<li>Inputs and outputs of functions are <a href="https://tibble.tidyverse.org/" class="external-link">tibbles</a>/dataframes or <a href="https://tidygraph.data-imaginist.com/" class="external-link">tidygraph tibbles</a>.</li>
<li>Generic modeling approach by using model and settings as function argument inputs. <!-- - Works with the [tidymodel](https://www.tidymodels.org/) approach, such as by  --> <!-- making use of [parsnip](https://parsnip.tidymodels.org/) functions to make the  --> <!-- models. -->
</li>
</ul>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>The general workflow for using NetCoupler revolves around several main functions, listed below as well as visualized in the figure below:</p>
<ul>
<li>
<code><a href="../reference/nc_standardize.html">nc_standardize()</a></code>: The algorithm in general, but especially the network estimation method, is sensitive to the values and distribution of the variables. Scaling the variables by standardizing, mean-centering, and natural log transforming them are important to obtaining more accurate estimations.</li>
<li>
<code><a href="../reference/nc_estimate_network.html">nc_estimate_network()</a></code>: Estimate the connections between metabolic variables as a undirected graph based on dependencies between variables. This network is used to identify metabolic variables that are connected to each other as neighbours.</li>
<li>
<code><a href="../reference/nc_estimate_links.html">nc_estimate_exposure_links()</a></code> and <code><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links()</a></code>: Uses the standardized data and the estimated network to classify the conditionally independent relationship between each metabolic variable and an external variable (e.g. an outcome or an exposure) as either being a direct, ambiguous, or no effect relationship.</li>
<li>
<code>nc_join_links()</code>: <strong>Not implemented yet.</strong> Join together the exposure- and outcome-side estimated links.</li>
<li>
<code>nc_plot_network()</code>: <strong>Not implemented yet.</strong> Visualize the connections estimated from <code><a href="../reference/nc_estimate_network.html">nc_estimate_network()</a></code>.</li>
<li>
<code>nc_plot_links()</code>: <strong>Not implemented yet.</strong> Plots the output results from either <code><a href="../reference/nc_estimate_links.html">nc_estimate_exposure_links()</a></code>, <code><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links()</a></code>, or <code>nc_join_links()</code>.</li>
</ul>
<div class="figure">
<img src="nc-diagram-io.png" alt=""><p class="caption">NetCoupler functions and their input and ouput. Input and output objects are the light gray boxes, while the light blue boxes are the currently available functions, and the light orange boxes are functions planned to be developed.</p>
</div>
</div>
<div class="section level2">
<h2 id="simple-example">Simple example<a class="anchor" aria-label="anchor" href="#simple-example"></a>
</h2>
<p>The below is an example using a simulated dataset for demonstrating NetCoupler.</p>
<div class="section level3">
<h3 id="estimating-the-metabolic-network">Estimating the metabolic network<a class="anchor" aria-label="anchor" href="#estimating-the-metabolic-network"></a>
</h3>
<p>For estimating the network, it’s (basically) required to standardize the metabolic variables before inputting into <code><a href="../reference/nc_estimate_network.html">nc_estimate_network()</a></code>. This function also log-transforms and scales (mean-center and z-score normalize) the values of the metabolic variables. We do this because the network estimation algorithm can sometimes be finicky about differences in variable numerical scale (mean of 1 vs mean of 1000).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/NetCoupler/NetCoupler" class="external-link">NetCoupler</a></span><span class="op">)</span>
<span class="va">std_metabolic_data</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="../reference/nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>If you intend to also adjust for potential confounders when estimating the exposure or outcome side connections, you can include the potential impact these confounders may have on the network by regressing the confounders on the metabolic variables. Then the residuals can be extracted and used when constructing the network. You do this also with the <code><a href="../reference/nc_standardize.html">nc_standardize()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">std_metabolic_data</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="../reference/nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span>,
                   regressed_on <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></code></pre></div>
<p>After that, you can estimate the network.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Make partial independence network from metabolite data</span>
<span class="va">metabolite_network</span> <span class="op">&lt;-</span> <span class="va">std_metabolic_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="../reference/nc_estimate_network.html">nc_estimate_network</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!-- To see what the network looks like, -->
<!-- use the function `nc_plot_network()`. -->
<!-- ```{r visualize-metabolic-network, fig.width=5.6, fig.height=4.5} -->
<!-- std_metabolic_data %>% -->
<!--     nc_plot_network(metabolite_network) -->
<!-- ``` -->
<!-- While the plot is a bit crowded, it at least provides a base to start tidying up -->
<!-- from. -->
</div>
<div class="section level3">
<h3 id="estimating-exposure-and-outcome-side-connections">Estimating exposure and outcome-side connections<a class="anchor" aria-label="anchor" href="#estimating-exposure-and-outcome-side-connections"></a>
</h3>
<p>For the exposure and outcome side, you should standardize the metabolic variables, but this time, we don’t regress on the confounders since they will be included in the models.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">standardized_data</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="../reference/nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now you can estimate the outcome or exposure and identify direct effects for either the exposure side (<code>exposure -&gt; metabolite</code>) or the outcome side (<code>metabolite -&gt; outcome</code>). For more details on the algorithm, see the <code><a href="../articles/description.html">vignette("description")</a></code>. For the exposure side, the function identifies whether a link between the exposure and an index node (one metabolic variable in the network) exists, independent of potential confounders and from neighbouring nodes (other metabolic variables linked to the index variable). Depending on how consistent and strong the link is, the effect is classified as “direct”, “ambiguous”, or “none”.</p>
<p>In the example below, we specifically generated the simulated data so that the exposure is associated with metabolites 1, 8, and 12. And as we can see, those links have been correctly identified.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outcome_estimates</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links</a></span><span class="op">(</span>
        edge_tbl <span class="op">=</span> <span class="fu"><a href="../reference/as_edge_tbl.html">as_edge_tbl</a></span><span class="op">(</span><span class="va">metabolite_network</span><span class="op">)</span>,
        outcome <span class="op">=</span> <span class="st">"outcome_continuous"</span>,
        model_function <span class="op">=</span> <span class="va">lm</span>
    <span class="op">)</span>
<span class="va">outcome_estimates</span>
<span class="co">#&gt; $full_model_list</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 301 × 9</span></span>
<span class="co">#&gt;    outcome       index_node model_id term  estimate std_error statistic  p_value</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> outcome_cont… metabolit… 42e63fc… (Int… -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">5</span>     0.025<span style="text-decoration: underline;">0</span>    -<span style="color: #BB0000;">0.738</span> 4.61<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> outcome_cont… metabolit… 42e63fc… meta…  0.066<span style="text-decoration: underline;">2</span>     0.025<span style="text-decoration: underline;">8</span>     2.57  1.03<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> outcome_cont… metabolit… 42e63fc… meta… -<span style="color: #BB0000;">0.049</span><span style="color: #BB0000; text-decoration: underline;">4</span>     0.025<span style="text-decoration: underline;">8</span>    -<span style="color: #BB0000;">1.92</span>  5.54<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> outcome_cont… metabolit… 84366fe… (Int… -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">5</span>     0.023<span style="text-decoration: underline;">8</span>    -<span style="color: #BB0000;">0.777</span> 4.37<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> outcome_cont… metabolit… 84366fe… meta… -<span style="color: #BB0000;">0.019</span><span style="color: #BB0000; text-decoration: underline;">8</span>     0.024<span style="text-decoration: underline;">3</span>    -<span style="color: #BB0000;">0.814</span> 4.16<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> outcome_cont… metabolit… 84366fe… meta…  0.364      0.024<span style="text-decoration: underline;">3</span>    15.0   3.50<span style="color: #949494;">e</span><span style="color: #BB0000;">-48</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> outcome_cont… metabolit… 9bc6200… (Int… -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">5</span>     0.023<span style="text-decoration: underline;">7</span>    -<span style="color: #BB0000;">0.778</span> 4.37<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> outcome_cont… metabolit… 9bc6200… meta… -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">62</span>    0.024<span style="text-decoration: underline;">9</span>    -<span style="color: #BB0000;">0.226</span> 8.21<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> outcome_cont… metabolit… 9bc6200… meta…  0.365      0.024<span style="text-decoration: underline;">2</span>    15.1   1.10<span style="color: #949494;">e</span><span style="color: #BB0000;">-48</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> outcome_cont… metabolit… 9bc6200… meta… -<span style="color: #BB0000;">0.060</span><span style="color: #BB0000; text-decoration: underline;">4</span>     0.024<span style="text-decoration: underline;">5</span>    -<span style="color: #BB0000;">2.47</span>  1.37<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 291 more rows, and 1 more variable: adjusted_vars &lt;chr&gt;</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $classified_effects</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 7</span></span>
<span class="co">#&gt;    outcome            index_node   estimate std_error p_value adj_p_value effect</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> outcome_continuous metabolite_1  0.054<span style="text-decoration: underline;">3</span>     0.025<span style="text-decoration: underline;">1</span> 3.02<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>    0.057<span style="text-decoration: underline;">7</span>   ambig…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> outcome_continuous metabolite_…  0.096<span style="text-decoration: underline;">5</span>     0.025<span style="text-decoration: underline;">0</span> 1.17<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>    0.000<span style="text-decoration: underline;">296</span> ambig…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> outcome_continuous metabolite_… -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">64</span>    0.025<span style="text-decoration: underline;">1</span> 7.61<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>    0.861    none  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> outcome_continuous metabolite_…  0.360      0.023<span style="text-decoration: underline;">8</span> 0   <span style="color: #949494;"> </span>      0        direct</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> outcome_continuous metabolite_2 -<span style="color: #BB0000;">0.033</span><span style="color: #BB0000; text-decoration: underline;">5</span>     0.025<span style="text-decoration: underline;">1</span> 1.81<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>    0.260    ambig…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> outcome_continuous metabolite_3 -<span style="color: #BB0000;">0.144</span>      0.024<span style="text-decoration: underline;">9</span> 0   <span style="color: #949494;"> </span>      0        direct</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> outcome_continuous metabolite_4  0.024<span style="text-decoration: underline;">4</span>     0.025<span style="text-decoration: underline;">1</span> 3.31<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>    0.452    ambig…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> outcome_continuous metabolite_5  0.029<span style="text-decoration: underline;">6</span>     0.025<span style="text-decoration: underline;">1</span> 2.38<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>    0.330    none  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> outcome_continuous metabolite_6  0.056<span style="text-decoration: underline;">0</span>     0.025<span style="text-decoration: underline;">0</span> 2.55<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>    0.049<span style="text-decoration: underline;">8</span>   ambig…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> outcome_continuous metabolite_7  0.002<span style="text-decoration: underline;">68</span>    0.025<span style="text-decoration: underline;">1</span> 9.15<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>    0.937    none  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">11</span> outcome_continuous metabolite_8  0.056<span style="text-decoration: underline;">7</span>     0.025<span style="text-decoration: underline;">0</span> 2.38<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>    0.047<span style="text-decoration: underline;">6</span>   ambig…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">12</span> outcome_continuous metabolite_9  0.212      0.024<span style="text-decoration: underline;">6</span> 0   <span style="color: #949494;"> </span>      0        direct</span>

<span class="va">exposure_estimates</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_exposure_links</a></span><span class="op">(</span>
        edge_tbl <span class="op">=</span> <span class="fu"><a href="../reference/as_edge_tbl.html">as_edge_tbl</a></span><span class="op">(</span><span class="va">metabolite_network</span><span class="op">)</span>,
        exposure <span class="op">=</span> <span class="st">"exposure"</span>,
        model_function <span class="op">=</span> <span class="va">lm</span>
    <span class="op">)</span>
<span class="va">exposure_estimates</span>
<span class="co">#&gt; $full_model_list</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 301 × 9</span></span>
<span class="co">#&gt;    exposure index_node   model_id    term  estimate std_error statistic  p_value</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> exposure metabolite_1 d54d16e09e… (Int… 0.000<span style="text-decoration: underline;">360</span>    0.021<span style="text-decoration: underline;">4</span>    0.016<span style="text-decoration: underline;">8</span> 9.87<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> exposure metabolite_1 d54d16e09e… expo… 0.180       0.021<span style="text-decoration: underline;">8</span>    8.26   2.71<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> exposure metabolite_1 d54d16e09e… meta… 0.242       0.021<span style="text-decoration: underline;">4</span>   11.3    8.56<span style="color: #949494;">e</span><span style="color: #BB0000;">-29</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> exposure metabolite_1 3e7b561192… (Int… 0.000<span style="text-decoration: underline;">358</span>    0.021<span style="text-decoration: underline;">5</span>    0.016<span style="text-decoration: underline;">6</span> 9.87<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> exposure metabolite_1 3e7b561192… expo… 0.179       0.022<span style="text-decoration: underline;">0</span>    8.16   6.07<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> exposure metabolite_1 3e7b561192… meta… 0.205       0.021<span style="text-decoration: underline;">6</span>    9.51   5.39<span style="color: #949494;">e</span><span style="color: #BB0000;">-21</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> exposure metabolite_1 275c2363be… (Int… 0.000<span style="text-decoration: underline;">362</span>    0.020<span style="text-decoration: underline;">9</span>    0.017<span style="text-decoration: underline;">3</span> 9.86<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> exposure metabolite_1 275c2363be… expo… 0.181       0.021<span style="text-decoration: underline;">4</span>    8.47   4.79<span style="color: #949494;">e</span><span style="color: #BB0000;">-17</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> exposure metabolite_1 275c2363be… meta… 0.187       0.021<span style="text-decoration: underline;">0</span>    8.92   1.06<span style="color: #949494;">e</span><span style="color: #BB0000;">-18</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> exposure metabolite_1 275c2363be… meta… 0.227       0.021<span style="text-decoration: underline;">0</span>   10.8    1.66<span style="color: #949494;">e</span><span style="color: #BB0000;">-26</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 291 more rows, and 1 more variable: adjusted_vars &lt;chr&gt;</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $classified_effects</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 7</span></span>
<span class="co">#&gt;    exposure index_node    estimate std_error  p_value adj_p_value effect   </span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> exposure metabolite_1   0.178      0.022<span style="text-decoration: underline;">5</span> 0          0         direct   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> exposure metabolite_10  0.298      0.021<span style="text-decoration: underline;">8</span> 0          0         direct   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> exposure metabolite_11 -<span style="color: #BB0000;">0.022</span><span style="color: #BB0000; text-decoration: underline;">6</span>     0.022<span style="text-decoration: underline;">8</span> 0.322      0.512     ambiguous</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> exposure metabolite_12 -<span style="color: #BB0000;">0.006</span><span style="color: #BB0000; text-decoration: underline;">41</span>    0.022<span style="text-decoration: underline;">8</span> 0.779      0.859     none     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> exposure metabolite_2  -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">88</span>    0.022<span style="text-decoration: underline;">8</span> 0.730      0.826     ambiguous</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> exposure metabolite_3   0.024<span style="text-decoration: underline;">1</span>     0.022<span style="text-decoration: underline;">8</span> 0.290      0.473     none     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> exposure metabolite_4  -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">54</span>    0.022<span style="text-decoration: underline;">8</span> 0.708      0.826     none     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> exposure metabolite_5   0.019<span style="text-decoration: underline;">1</span>     0.022<span style="text-decoration: underline;">8</span> 0.402      0.576     none     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> exposure metabolite_6  -<span style="color: #BB0000;">0.015</span><span style="color: #BB0000; text-decoration: underline;">1</span>     0.022<span style="text-decoration: underline;">8</span> 0.507      0.683     none     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> exposure metabolite_7  -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">6</span>     0.022<span style="text-decoration: underline;">7</span> 0.000<span style="text-decoration: underline;">018</span>   0.000<span style="text-decoration: underline;">053</span>4 ambiguous</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">11</span> exposure metabolite_8  -<span style="color: #BB0000;">0.343</span>      0.021<span style="text-decoration: underline;">5</span> 0          0         direct   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">12</span> exposure metabolite_9   0.102      0.022<span style="text-decoration: underline;">7</span> 0.000<span style="text-decoration: underline;">007</span>   0.000<span style="text-decoration: underline;">024</span>1 ambiguous</span></code></pre></div>
<p>If you want to adjust for confounders and have already used <code>regressed_on</code> in the <code><a href="../reference/nc_standardize.html">nc_standardize()</a></code> function, add confounders to <code><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links()</a></code> or <code><a href="../reference/nc_estimate_links.html">nc_estimate_exposure_links()</a></code> with the <code>adjustment_vars</code> argument:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outcome_estimates</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links</a></span><span class="op">(</span>
        edge_tbl <span class="op">=</span> <span class="fu"><a href="../reference/as_edge_tbl.html">as_edge_tbl</a></span><span class="op">(</span><span class="va">metabolite_network</span><span class="op">)</span>,
        outcome <span class="op">=</span> <span class="st">"outcome_continuous"</span>,
        model_function <span class="op">=</span> <span class="va">lm</span>,
        adjustment_vars <span class="op">=</span> <span class="st">"age"</span>
    <span class="op">)</span></code></pre></div>
<!-- ### Plotting  -->
<!-- To visualize the results of the linked network graph and the effect -->
<!-- classification, there are two functions to show the exposure and the outcome -->
<!-- plots. In general, these plot functions are currently mostly for exploratory -->
<!-- purposes and are too "busy" and crowded to be meaningful for presentation or -->
<!-- publication. However, these are good starting points for making prettier, -->
<!-- more legible plots. -->
<!-- ```{r plot-outcome-estimation-networks, fig.width=7, fig.height=6} -->
<!-- nc_plot_outcome_estimation( -->
<!--     standardized_data, -->
<!--     metabolite_network, -->
<!--     outcome_estimates -->
<!-- ) -->
<!-- ``` -->
<!-- ```{r plot-exposure-estimation-networks, fig.width=7, fig.height=6} -->
<!-- nc_plot_exposure_estimation( -->
<!--     standardized_data, -->
<!--     metabolite_network, -->
<!--     exposure_estimates -->
<!-- ) -->
<!-- ``` -->
<!-- ## Slow code? Use parallel processing with future -->
<!-- If the analysis is taking a while, you can use the future package to speed things -->
<!-- up by implementing parallel processing. Set the `.parallel` argument to `TRUE` -->
<!-- in either `nc_estimate_outcome_links()` or `nc_estimate_exposure_links()` and then use -->
<!-- the future package with a given `plan()`. If you use RStudio, the only usable -->
<!-- strategy is `multisession`. After you run your code, close up the parallel -->
<!-- processing by putting it back to normal with `plan(sequential)`. Using the future -->
<!-- package you can speed up the processing by almost 2.5 times. -->
<!-- ```{r future-parallel-processing, eval=FALSE} -->
<!-- library(future) -->
<!-- plan(multisession) -->
<!-- outcome_estimates <- standardized_data %>% -->
<!--     nc_estimate_outcome_links( -->
<!--         edge_tbl = as_edge_tbl(metabolite_network), -->
<!--         outcome = "outcome_continuous", -->
<!--         model_function = lm, -->
<!--         .parallel = TRUE -->
<!--     ) -->
<!-- plan(sequential) -->
<!-- ``` -->
<!-- - complete cases for all variables used by netcoupler -->
<div id="refs" class="references">
<div id="ref-Colombo2014">
<p>Colombo, Diego, and Marloes H. Maathuis. 2014. “Order-Independent Constraint-Based Causal Structure Learning.” <em>Journal of Machine Learning Research</em> 15 (1): 3741–82. <a href="http://dl.acm.org/citation.cfm?id=2627435.2750365" class="external-link">http://dl.acm.org/citation.cfm?id=2627435.2750365</a>.</p>
</div>
<div id="ref-Wittenbecher2017">
<p>Wittenbecher, Clemens. 2017. “Linking Whole-Grain Bread, Coffee, and Red Meat to the Risk of Type 2 Diabetes.” Doctoralthesis, Universität Potsdam. <a href="https://nbn-resolving.org/urn:nbn:de:kobv:517-opus4-404592" class="external-link">https://nbn-resolving.org/urn:nbn:de:kobv:517-opus4-404592</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Luke Johnston, Clemens Wittenbecher.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="NetCoupler">
<title>Getting started with NetCoupler • NetCoupler</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with NetCoupler">
<meta property="og:description" content="NetCoupler">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NetCoupler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/NetCoupler.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/examples.html">Examples of using NetCoupler with different models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/NetCoupler/NetCoupler/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting started with NetCoupler</h1>
            
            <h4 data-toc-skip class="date">2024-01-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/NetCoupler/NetCoupler/blob/HEAD/vignettes/NetCoupler.Rmd" class="external-link"><code>vignettes/NetCoupler.Rmd</code></a></small>
      <div class="d-none name"><code>NetCoupler.Rmd</code></div>
    </div>

    
    
<p>The goal of NetCoupler is to estimate causal links between a set of
-omic (e.g. metabolomics, lipidomics) or other high-dimensional data and
an external variable, such as a disease outcome, an exposure, or both.
The NetCoupler-algorithm, initially formulated during Clemens’ PhD
thesis <span class="citation">(Wittenbecher 2017)</span>, links a
conditional dependency network with an external variable (i.e. an
outcome or exposure) to identify network-independent associations
between the network variables and the external variable, classified as
direct effects.</p>
<!-- TODO: Add link to the description vignette -->
<p>A typical use case we have in mind would be if a researcher might be
interested in exploring potential pathways that exist between a health
exposure like red meat consumption, its impact on the metabolic profile,
and the subsequent impact on an outcome like type 2 diabetes incidence.
So for instance, you want to ask questions to get answers that look like
the figure below.</p>
<div class="figure">
<img src="aim-output.png" alt=""><p class="caption">The structure of questions that NetCoupler aims to
help answers or explore.</p>
</div>
<p>The input for NetCoupler includes:</p>
<ol style="list-style-type: decimal">
<li>Standardized metabolic or other high-dimensional data.</li>
<li>Exposure or outcome data.</li>
<li>Network estimating method (default is the PC algorithm <span class="citation">(Colombo and Maathuis 2014)</span> from the <a href="https://CRAN.R-project.org/package=pcalg" class="external-link">pcalg</a> package).</li>
<li>Modeling method (e.g. linear regression with <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>),
including confounders to adjust for.</li>
</ol>
<!-- TODO: Add figure demonstrating NetCoupler --><p>The final output is the modeling results along with the results from
NetCoupler’s classification. Results can then be displayed as a joint
network model in graphical format.</p>
<p>There are a few key assumptions to consider before using NetCoupler
for your own research purposes.</p>
<!-- TODO: Add link to assumptions of PC-algorithm -->
<ol style="list-style-type: decimal">
<li>-omics data is the basis for the network. We haven’t tested this on
non-omics datasets, so can’t guarantee it works as intended.</li>
<li>The variables used for the metabolic network are numerical</li>
<li>Metabolic data should have a theoretical network underlying it.</li>
<li>Missing data are not used in any of the NetCoupler processes.</li>
</ol>
<!-- TODO: Add other assumptions --><div class="section level2">
<h2 id="overall-package-framework">Overall package framework<a class="anchor" aria-label="anchor" href="#overall-package-framework"></a>
</h2>
<p>NetCoupler has several frameworks in mind:</p>
<ul>
<li>Works with <a href="https://magrittr.tidyverse.org/" class="external-link">magrittr</a>
<code>%&gt;%</code> or base R <code>|&gt;</code> operator.</li>
<li>Works with <a href="https://tidyselect.r-lib.org/" class="external-link">tidyselect</a>
helpers (e.g. <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains()</a></code>).</li>
<li>Is auto-complete friendly (e.g. start function names with
<code>nc_</code>).</li>
<li>Inputs and outputs of functions are <a href="https://tibble.tidyverse.org/" class="external-link">tibbles</a>/dataframes or <a href="https://tidygraph.data-imaginist.com/" class="external-link">tidygraph tibbles</a>.</li>
<li>Generic modeling approach by using model and settings as function
argument inputs.
<ul>
<li>This allows flexibility with what model can be used (e.g. linear
regression, cox models).</li>
<li>Almost all functionality of modeling in R is available here, for
instance handling of missing data or of categorical variables.</li>
</ul>
</li>
</ul>
<!-- - Works with the [tidymodel](https://www.tidymodels.org/) approach, such as by  --><!-- making use of [parsnip](https://parsnip.tidymodels.org/) functions to make the  --><!-- models. -->
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>The general workflow for using NetCoupler revolves around several
main functions, listed below as well as visualized in the figure
below:</p>
<ul>
<li>
<code><a href="../reference/nc_standardize.html">nc_standardize()</a></code>: The algorithm in general, but
especially the network estimation method, is sensitive to the values and
distribution of the variables. Scaling the variables by standardizing,
mean-centering, and natural log transforming them are important to
obtaining more accurate estimations.</li>
<li>
<code><a href="../reference/nc_estimate_network.html">nc_estimate_network()</a></code>: Estimate the connections between
metabolic variables as a undirected graph based on dependencies between
variables. This network is used to identify metabolic variables that are
connected to each other as neighbours.
<ul>
<li>We plan on implementing other network estimators aside from the
PC-algorithm at some point in the future.</li>
</ul>
</li>
<li>
<code><a href="../reference/nc_estimate_links.html">nc_estimate_exposure_links()</a></code> and
<code><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links()</a></code>: Uses the standardized data and
the estimated network to classify the conditionally independent
relationship between each metabolic variable and an external variable
(e.g. an outcome or an exposure) as either being a direct, ambiguous, or
no effect relationship.
<ul>
<li>Setting the threshold for classifying effects as direct, ambigious,
or none is done through the argument <code>classify_option_list</code>.
See the help documentation of the estimating functions for more details.
For larger datasets, with more sample size and variables included in the
network, we <em>strongly</em> recommend lowering the threshold used to
reduce the risk of false positives.</li>
</ul>
</li>
<li>
<code>nc_join_links()</code>: <strong>Not implemented yet.</strong>
Join together the exposure- and outcome-side estimated links.</li>
<li>
<code>nc_plot_network()</code>: <strong>Not implemented
yet.</strong> Visualize the connections estimated from
<code><a href="../reference/nc_estimate_network.html">nc_estimate_network()</a></code>.</li>
<li>
<code>nc_plot_links()</code>: <strong>Not implemented yet.</strong>
Plots the output results from either
<code><a href="../reference/nc_estimate_links.html">nc_estimate_exposure_links()</a></code>,
<code><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links()</a></code>, or
<code>nc_join_links()</code>.</li>
</ul>
<div class="figure">
<img src="nc-diagram-io.png" alt="NetCoupler functions and their input and ouput. Input and output     objects are the light gray boxes, while the light blue boxes are the     currently available functions, and the light orange boxes are functions     planned to be developed." width="60%"><p class="caption">
NetCoupler functions and their input and ouput. Input and output objects
are the light gray boxes, while the light blue boxes are the currently
available functions, and the light orange boxes are functions planned to
be developed.
</p>
</div>
</div>
<div class="section level2">
<h2 id="simple-example">Simple example<a class="anchor" aria-label="anchor" href="#simple-example"></a>
</h2>
<p>The below is an example using a simulated dataset for demonstrating
NetCoupler. For more examples, particularly on how to use with different
models, check out the <code><a href="../articles/examples.html">vignette("examples")</a></code>.</p>
<div class="section level3">
<h3 id="estimating-the-metabolic-network">Estimating the metabolic network<a class="anchor" aria-label="anchor" href="#estimating-the-metabolic-network"></a>
</h3>
<p>For estimating the network, it’s (basically) required to standardize
the metabolic variables before inputting into
<code><a href="../reference/nc_estimate_network.html">nc_estimate_network()</a></code>. This function also log-transforms
and scales (mean-center and z-score normalize) the values of the
metabolic variables. We do this because the network estimation algorithm
can sometimes be finicky about differences in variable numerical scale
(mean of 1 vs mean of 1000).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/NetCoupler/NetCoupler" class="external-link">NetCoupler</a></span><span class="op">)</span></span>
<span><span class="va">std_metabolic_data</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If you have potential confounders that you need to adjust for during
the estimating links phase of NetCoupler, you’ll need to include these
confounding variables when standardizing the metabolic variables. You do
this by regressing the confounding variables on the metabolic variables
by using the <code>regressed_on</code> argument of
<code><a href="../reference/nc_standardize.html">nc_standardize()</a></code>. This will automatically first standardize
the variables, run models on the metabolic variables that includes the
confounding variables, and then extract the residuals from the model
which are then used to construct the network. Here’s an example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">std_metabolic_data</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span>,</span>
<span>                   regressed_on <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span></code></pre></div>
<p>After that, you can estimate the network. The network is by default
estimated using the PC-algorithm. You can read more about it in the help
page of the <code><a href="../reference/pc_estimate_undirected_graph.html">pc_estimate_undirected_graph()</a></code> internal
function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make partial independence network from metabolite data</span></span>
<span><span class="va">metabolite_network</span> <span class="op">&lt;-</span> <span class="va">std_metabolic_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/nc_estimate_network.html">nc_estimate_network</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<!-- To see what the network looks like, -->
<!-- use the function `nc_plot_network()`. -->
<!-- ```{r visualize-metabolic-network, fig.width=5.6, fig.height=4.5} -->
<!-- std_metabolic_data %>% -->
<!--     nc_plot_network(metabolite_network) -->
<!-- ``` -->
<!-- While the plot is a bit crowded, it at least provides a base to start tidying up -->
<!-- from. -->
</div>
<div class="section level3">
<h3 id="estimating-exposure-and-outcome-side-connections">Estimating exposure and outcome-side connections<a class="anchor" aria-label="anchor" href="#estimating-exposure-and-outcome-side-connections"></a>
</h3>
<p>For the exposure and outcome side, you should standardize the
metabolic variables, but this time, we don’t regress on the confounders
since they will be included in the models.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standardized_data</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now you can estimate the outcome or exposure and identify direct
effects for either the exposure side
(<code>exposure -&gt; metabolite</code>) or the outcome side
(<code>metabolite -&gt; outcome</code>). For the exposure side, the
function identifies whether a link between the exposure and an index
node (one metabolic variable in the network) exists, independent of
potential confounders and from neighbouring nodes (other metabolic
variables linked to the index variable). Depending on how consistent and
strong the link is, the effect is classified as “direct”, “ambiguous”,
or “none”.
<!-- For more details on the algorithm, see the `vignette("description")`. --></p>
<p>In the example below, we specifically generated the simulated data so
that the exposure is associated with metabolites 1, 8, and 12. And as we
can see, those links have been correctly identified.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcome_estimates</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links</a></span><span class="op">(</span></span>
<span>        edge_tbl <span class="op">=</span> <span class="fu"><a href="../reference/as_edge_tbl.html">as_edge_tbl</a></span><span class="op">(</span><span class="va">metabolite_network</span><span class="op">)</span>,</span>
<span>        outcome <span class="op">=</span> <span class="st">"outcome_continuous"</span>,</span>
<span>        model_function <span class="op">=</span> <span class="va">lm</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">outcome_estimates</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 6</span></span></span>
<span><span class="co">#&gt;    outcome            index_node    estimate std_error fdr_p_value effect   </span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> outcome_continuous metabolite_1   0.046<span style="text-decoration: underline;">6</span>     0.025<span style="text-decoration: underline;">4</span>   0.124     ambiguous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> outcome_continuous metabolite_10  0.004<span style="text-decoration: underline;">49</span>    0.025<span style="text-decoration: underline;">4</span>   0.947     ambiguous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> outcome_continuous metabolite_11 -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">00</span>    0.025<span style="text-decoration: underline;">4</span>   0.912     none     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> outcome_continuous metabolite_12  0.350      0.024<span style="text-decoration: underline;">2</span>   0         direct   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> outcome_continuous metabolite_2  -<span style="color: #BB0000;">0.028</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.025<span style="text-decoration: underline;">5</span>   0.424     none     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> outcome_continuous metabolite_3  -<span style="color: #BB0000;">0.093</span><span style="color: #BB0000; text-decoration: underline;">6</span>     0.025<span style="text-decoration: underline;">2</span>   0.000<span style="text-decoration: underline;">620</span>  direct   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> outcome_continuous metabolite_4   0.026<span style="text-decoration: underline;">7</span>     0.025<span style="text-decoration: underline;">6</span>   0.453     ambiguous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> outcome_continuous metabolite_5   0.103      0.025<span style="text-decoration: underline;">3</span>   0.000<span style="text-decoration: underline;">167</span>  ambiguous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> outcome_continuous metabolite_6   0.113      0.025<span style="text-decoration: underline;">2</span>   0.000<span style="text-decoration: underline;">023</span>7 ambiguous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> outcome_continuous metabolite_7   0.001<span style="text-decoration: underline;">71</span>    0.025<span style="text-decoration: underline;">5</span>   0.956     none     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> outcome_continuous metabolite_8   0.021<span style="text-decoration: underline;">2</span>     0.025<span style="text-decoration: underline;">3</span>   0.548     none     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> outcome_continuous metabolite_9   0.201      0.025<span style="text-decoration: underline;">0</span>   0         direct</span></span>
<span></span>
<span><span class="va">exposure_estimates</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_exposure_links</a></span><span class="op">(</span></span>
<span>        edge_tbl <span class="op">=</span> <span class="fu"><a href="../reference/as_edge_tbl.html">as_edge_tbl</a></span><span class="op">(</span><span class="va">metabolite_network</span><span class="op">)</span>,</span>
<span>        exposure <span class="op">=</span> <span class="st">"exposure"</span>,</span>
<span>        model_function <span class="op">=</span> <span class="va">lm</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">exposure_estimates</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 6</span></span></span>
<span><span class="co">#&gt;    exposure index_node    estimate std_error fdr_p_value effect   </span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> exposure metabolite_1   0.173      0.022<span style="text-decoration: underline;">8</span>      0      direct   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> exposure metabolite_10  0.318      0.021<span style="text-decoration: underline;">9</span>      0      direct   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> exposure metabolite_11  0.054<span style="text-decoration: underline;">3</span>     0.023<span style="text-decoration: underline;">2</span>      0.040<span style="text-decoration: underline;">9</span> ambiguous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> exposure metabolite_12  0.024<span style="text-decoration: underline;">2</span>     0.023<span style="text-decoration: underline;">1</span>      0.380  none     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> exposure metabolite_2  -<span style="color: #BB0000;">0.043</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.023<span style="text-decoration: underline;">1</span>      0.106  ambiguous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> exposure metabolite_3   0.041<span style="text-decoration: underline;">1</span>     0.023<span style="text-decoration: underline;">1</span>      0.123  ambiguous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> exposure metabolite_4   0.003<span style="text-decoration: underline;">44</span>    0.023<span style="text-decoration: underline;">2</span>      0.920  none     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> exposure metabolite_5   0.047<span style="text-decoration: underline;">9</span>     0.023<span style="text-decoration: underline;">2</span>      0.071<span style="text-decoration: underline;">7</span> ambiguous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> exposure metabolite_6  -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">9</span>     0.023<span style="text-decoration: underline;">0</span>      0.506  none     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> exposure metabolite_7  -<span style="color: #BB0000;">0.162</span>      0.022<span style="text-decoration: underline;">9</span>      0      direct   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> exposure metabolite_8  -<span style="color: #BB0000;">0.355</span>      0.021<span style="text-decoration: underline;">6</span>      0      direct   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> exposure metabolite_9   0.057<span style="text-decoration: underline;">1</span>     0.023<span style="text-decoration: underline;">0</span>      0.029<span style="text-decoration: underline;">2</span> ambiguous</span></span></code></pre></div>
<p>If you want to adjust for confounders and have already used
<code>regressed_on</code> in the <code><a href="../reference/nc_standardize.html">nc_standardize()</a></code> function,
add confounders to <code><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links()</a></code> or
<code><a href="../reference/nc_estimate_links.html">nc_estimate_exposure_links()</a></code> with the
<code>adjustment_vars</code> argument:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcome_estimates</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links</a></span><span class="op">(</span></span>
<span>        edge_tbl <span class="op">=</span> <span class="fu"><a href="../reference/as_edge_tbl.html">as_edge_tbl</a></span><span class="op">(</span><span class="va">metabolite_network</span><span class="op">)</span>,</span>
<span>        outcome <span class="op">=</span> <span class="st">"outcome_continuous"</span>,</span>
<span>        model_function <span class="op">=</span> <span class="va">lm</span>,</span>
<span>        adjustment_vars <span class="op">=</span> <span class="st">"age"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<!-- TODO: More about when to adjust and why and how. -->
<!-- ### Plotting  -->
<!-- To visualize the results of the linked network graph and the effect -->
<!-- classification, there are two functions to show the exposure and the outcome -->
<!-- plots. In general, these plot functions are currently mostly for exploratory -->
<!-- purposes and are too "busy" and crowded to be meaningful for presentation or -->
<!-- publication. However, these are good starting points for making prettier, -->
<!-- more legible plots. -->
<!-- ```{r plot-outcome-estimation-networks, fig.width=7, fig.height=6} -->
<!-- nc_plot_outcome_estimation( -->
<!--     standardized_data, -->
<!--     metabolite_network, -->
<!--     outcome_estimates -->
<!-- ) -->
<!-- ``` -->
<!-- ```{r plot-exposure-estimation-networks, fig.width=7, fig.height=6} -->
<!-- nc_plot_exposure_estimation( -->
<!--     standardized_data, -->
<!--     metabolite_network, -->
<!--     exposure_estimates -->
<!-- ) -->
<!-- ``` -->
</div>
</div>
<div class="section level2">
<h2 id="slow-code-use-parallel-processing-with-future">Slow code? Use parallel processing with future<a class="anchor" aria-label="anchor" href="#slow-code-use-parallel-processing-with-future"></a>
</h2>
<p>If the analysis is taking a while, you can use the future package to
speed things up by implementing parallel processing. It’s easy to use
parallel processing with NetCoupler since it uses the future package. By
setting the “processing plan” with <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a></code> to
<code>multisession</code>, NetCoupler will use parallel processing for
its computationally intensive component of the algorithm. After you run
your code, close up the parallel processing by putting it back to normal
with <code>plan(sequential)</code>. Using the future package you can
speed up the processing by almost 2.5 times.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># You'll need to have furrr installed for this to work.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span><span class="va">outcome_estimates</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links</a></span><span class="op">(</span></span>
<span>        edge_tbl <span class="op">=</span> <span class="fu"><a href="../reference/as_edge_tbl.html">as_edge_tbl</a></span><span class="op">(</span><span class="va">metabolite_network</span><span class="op">)</span>,</span>
<span>        outcome <span class="op">=</span> <span class="st">"outcome_continuous"</span>,</span>
<span>        model_function <span class="op">=</span> <span class="va">lm</span></span>
<span>    <span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></code></pre></div>
<!-- - complete cases for all variables used by netcoupler -->
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Colombo2014" class="csl-entry">
Colombo, Diego, and Marloes H. Maathuis. 2014. <span>“Order-Independent
Constraint-Based Causal Structure Learning.”</span> <em>Journal of
Machine Learning Research</em> 15 (1): 3741–82. <a href="https://dl.acm.org/doi/10.5555/2627435.2750365" class="external-link">https://dl.acm.org/doi/10.5555/2627435.2750365</a>.
</div>
<div id="ref-Wittenbecher2017" class="csl-entry">
Wittenbecher, Clemens. 2017. <span>“Linking Whole-Grain Bread, Coffee,
and Red Meat to the Risk of Type 2 Diabetes.”</span> Doctoralthesis,
Universit<span>ä</span>t Potsdam. <a href="https://nbn-resolving.org/urn:nbn:de:kobv:517-opus4-404592" class="external-link">https://nbn-resolving.org/urn:nbn:de:kobv:517-opus4-404592</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Luke Johnston, Clemens Wittenbecher.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

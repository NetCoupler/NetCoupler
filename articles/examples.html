<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples of using NetCoupler with different models • NetCoupler</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples of using NetCoupler with different models">
<meta property="og:description" content="NetCoupler">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NetCoupler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/NetCoupler.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/examples.html">Examples of using NetCoupler with different models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/NetCoupler/NetCoupler/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="examples_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Examples of using NetCoupler with different models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/NetCoupler/NetCoupler/blob/HEAD/vignettes/articles/examples.Rmd" class="external-link"><code>vignettes/articles/examples.Rmd</code></a></small>
      <div class="hidden name"><code>examples.Rmd</code></div>

    </div>

    
    
<p>This article contains a list of models that you could use in NetCoupler as well as some published real-world examples of it being used.</p>
<p>There are some caveats to most of these examples, except for when a section explicitly indicates otherwise:</p>
<ul>
<li>Most of the models do not include further adjustment for confounders.</li>
<li>Most models only show the outcome-side estimation, for brevity. However, the code for running exposure-side estimation is almost the exact same.</li>
</ul>
<p>Across the different models, there are some general features, which is described in more depth in the <a href="netcoupler.html">Getting Started</a> article.</p>
<div class="section level2">
<h2 id="pre-processing">Pre-processing<a class="anchor" aria-label="anchor" href="#pre-processing"></a>
</h2>
<p>First load up the packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/NetCoupler/NetCoupler" class="external-link">NetCoupler</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>
<p>Pre-processing by standardizing variables, since large differences in the values of variables can impact on the results of the algorithm.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">standardized_data</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="../reference/nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</li>
<li>
<p>Estimating the network structure to identify links between the metabolic variables. This network needs to be converted into an edge table that has two columns, one for the <code>source_node</code> and another for the <code>target_node</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">metabolite_network</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="../reference/nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="../reference/nc_estimate_network.html">nc_estimate_network</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span>

<span class="va">edge_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_edge_tbl.html">as_edge_tbl</a></span><span class="op">(</span><span class="va">metabolite_network</span><span class="op">)</span>
<span class="va">edge_table</span></code></pre></div>
</li>
<li>
<p>If adjusting for confounders in the main models, these also need to be included when estimating the network. To do this, the metabolic data needs to be regressed on to the variables that will be standardized.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">metabolite_network</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="../reference/nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span>,
                   regressed_on <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="../reference/nc_estimate_network.html">nc_estimate_network</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</li>
</ol>
<div class="section level3">
<h3 id="outcome-vs-exposure-side">Outcome vs exposure side<a class="anchor" aria-label="anchor" href="#outcome-vs-exposure-side"></a>
</h3>
<p>Let’s revisit this image:</p>
<div class="figure">
<img src="aim-question.png" alt=""><p class="caption">General form for questions that NetCoupler aims to help answer.</p>
</div>
<p>All types of models can be used for either the left hand side of this graph (the exposure side) or the right hand side (the outcome). If we want to estimate the links on the exposure side, where we’re interested in how a variable might influence the network, we would use the <code><a href="../reference/nc_estimate_links.html">nc_estimate_exposure_links()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_exposure_links</a></span><span class="op">(</span>
    edge_tbl <span class="op">=</span> <span class="va">edge_table</span>,
    exposure <span class="op">=</span> <span class="st">"exposure"</span>,
    model_function <span class="op">=</span> <span class="va">lm</span>
  <span class="op">)</span></code></pre></div>
<p>If we are interested the outcome side, where we want to know how the network might influence the outcome, we would use the <code><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links</a></span><span class="op">(</span>
    edge_tbl <span class="op">=</span> <span class="va">edge_table</span>,
    outcome <span class="op">=</span> <span class="st">"outcome_continuous"</span>,
    model_function <span class="op">=</span> <span class="va">lm</span>
  <span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="linear-regression">Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h2>
<p>This is the easiest and will probably be the most commonly used modeling method used when running NetCoupler. Adding additional arguments to settings to the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> (or <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>) function can be done by using the <code>model_args_list</code> argument.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lm_results</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links</a></span><span class="op">(</span>
    edge_tbl <span class="op">=</span> <span class="va">edge_table</span>,
    outcome <span class="op">=</span> <span class="st">"outcome_continuous"</span>,
    model_function <span class="op">=</span> <span class="va">lm</span>
  <span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="logistic-regression">Logistic regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h2>
<div class="section level3">
<h3 id="binary-logistic-regression">Binary Logistic Regression<a class="anchor" aria-label="anchor" href="#binary-logistic-regression"></a>
</h3>
<p>Probably the second most common model would be the binary classic logistic regression. Unlike the linear regression modeling above, we need to use the <code>model_arg_list</code> argument in order to tell <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> to use the binomial method for model estimation.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">glm_bin_results</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links</a></span><span class="op">(</span>
    edge_tbl <span class="op">=</span> <span class="va">edge_table</span>,
    outcome <span class="op">=</span> <span class="st">"outcome_binary"</span>,
    model_function <span class="op">=</span> <span class="va">glm</span>,
    model_arg_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span>,
    exponentiate <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span></code></pre></div>
<!-- 
### Ordinal Logistic Regression 

### Nominal Logistic Regression

### Conditional Logistic Regression
-->
</div>
</div>
<div class="section level2">
<h2 id="cox-proportional-hazards-regression">Cox proportional hazards regression<a class="anchor" aria-label="anchor" href="#cox-proportional-hazards-regression"></a>
</h2>
<p>With Cox models, the response/y variable usually needs to be a <code><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">survival::Surv()</a></code> object. While you can use this function in the <code>outcome</code>/<code>exposure</code> argument of the <code><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links()</a></code> or <code><a href="../reference/nc_estimate_links.html">nc_estimate_exposure_links()</a></code> functions, to keep the code and output a bit cleaner, we recommend creating the survival object beforehand with <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
<span class="va">cox_surv_data</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>surv_object <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span>
        time <span class="op">=</span> <span class="va">age</span>,
        time2 <span class="op">=</span> <span class="va">age</span> <span class="op">+</span> <span class="va">outcome_event_time</span>,
        event <span class="op">=</span> <span class="va">outcome_binary</span>
    <span class="op">)</span><span class="op">)</span> 

<span class="va">coxph_results</span> <span class="op">&lt;-</span> <span class="va">cox_surv_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links</a></span><span class="op">(</span>
    edge_tbl <span class="op">=</span> <span class="va">edge_table</span>,
    outcome <span class="op">=</span> <span class="st">"surv_object"</span>,
    <span class="co"># Can also use Surv directly.</span>
    <span class="co"># outcome = "Surv(time = time_start, time2 = time_end, event = outcome_binary)",</span>
    model_function <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span>
  <span class="op">)</span></code></pre></div>
<p>You might want to add a clustering to calculate robust standard errors or to add a strata variable. You add these directly to the adjustment variable argument.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coxph_results_cluster</span> <span class="op">&lt;-</span> <span class="va">cox_surv_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="../reference/nc_estimate_links.html">nc_estimate_outcome_links</a></span><span class="op">(</span>
        edge_tbl <span class="op">=</span> <span class="va">edge_table</span>,
        outcome <span class="op">=</span> <span class="st">"surv_object"</span>,
        adjustment_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"strata(age)"</span>, <span class="st">"cluster(id)"</span><span class="op">)</span>,
        model_function <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span>
    <span class="op">)</span></code></pre></div>
<!-- 
## Poisson regression 

### Negative Binomial Regression
### Zero-inflated regression

## Polynomial Regression

## Ridge Regression

## Lasso Regression

## Quantile Regression

## Elastic Net Regression

## Principal Components Regression

## Support Vector Machines Regression

## Quasi Poisson Regression

## Tobit Regression

## Multivariate Regression

## Random effects models

## Longitudinal data? 

-->
<!-- # Real-world uses in published works -->
<div id="refs" class="references">
<div id="ref-Wittenbecher2022">
<p>Wittenbecher, C., R. Cuadrat, L. Johnston, F. Eichelmann, S. Jäger, O. Kuxhaus, M. Prada, et al. 2022. “Dihydroceramide- and Ceramide-Profiling Provides Insights into Human Cardiometabolic Disease Etiology.” <em>Nature Communications</em> 13 (1). <a href="https://doi.org/10.1038/s41467-022-28496-1" class="external-link">https://doi.org/10.1038/s41467-022-28496-1</a>.</p>
</div>
<div id="ref-Wittenbecher2017">
<p>Wittenbecher, Clemens. 2017. “Linking Whole-Grain Bread, Coffee, and Red Meat to the Risk of Type 2 Diabetes.” Doctoralthesis, Universität Potsdam. <a href="https://nbn-resolving.org/urn:nbn:de:kobv:517-opus4-404592" class="external-link">https://nbn-resolving.org/urn:nbn:de:kobv:517-opus4-404592</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Luke Johnston, Clemens Wittenbecher.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

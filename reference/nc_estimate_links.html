<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute model estimates between an external (exposure or outcome) variable and a network. — nc_estimate_links • NetCoupler</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute model estimates between an external (exposure or outcome) variable and a network. — nc_estimate_links"><meta name="description" content="
This is the main function that identifies potential links between external factors
and the network. There are two functions to estimate and classify links:
nc_estimate_exposure_links(): Computes the model estimates for the exposure side.
nc_estimate_outcome_links(): Computes the model estimates for the exposure side.

"><meta property="og:description" content="
This is the main function that identifies potential links between external factors
and the network. There are two functions to estimate and classify links:
nc_estimate_exposure_links(): Computes the model estimates for the exposure side.
nc_estimate_outcome_links(): Computes the model estimates for the exposure side.

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NetCoupler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/NetCoupler.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/examples.html">Examples of using NetCoupler with different models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NetCoupler/NetCoupler/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute model estimates between an external (exposure or outcome) variable and a network.</h1>
      <small class="dont-index">Source: <a href="https://github.com/NetCoupler/NetCoupler/blob/main/R/estimate-links.R" class="external-link"><code>R/estimate-links.R</code></a></small>
      <div class="d-none name"><code>nc_estimate_links.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>This is the main function that identifies potential links between external factors
and the network. There are two functions to estimate and classify links:</p><ul><li><p><code>nc_estimate_exposure_links()</code>: Computes the model estimates for the exposure side.</p></li>
<li><p><code>nc_estimate_outcome_links()</code>: Computes the model estimates for the exposure side.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nc_estimate_exposure_links</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">edge_tbl</span>,</span>
<span>  <span class="va">exposure</span>,</span>
<span>  adjustment_vars <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">model_function</span>,</span>
<span>  model_arg_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exponentiate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  classify_option_list <span class="op">=</span> <span class="fu"><a href="classify_options.html">classify_options</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">nc_estimate_outcome_links</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">edge_tbl</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  adjustment_vars <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">model_function</span>,</span>
<span>  model_arg_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exponentiate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  classify_option_list <span class="op">=</span> <span class="fu"><a href="classify_options.html">classify_options</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data.frame or tibble that contains the variables of interest,
including the variables used to make the network.</p></dd>


<dt id="arg-edge-tbl">edge_tbl<a class="anchor" aria-label="anchor" href="#arg-edge-tbl"></a></dt>
<dd><p>Output graph object from <code><a href="nc_estimate_network.html">nc_estimate_network()</a></code>, converted
to an edge table using <code><a href="as_edge_tbl.html">as_edge_tbl()</a></code>.</p></dd>


<dt id="arg-exposure-outcome">exposure, outcome<a class="anchor" aria-label="anchor" href="#arg-exposure-outcome"></a></dt>
<dd><p>Character. The exposure or outcome variable of interest.</p></dd>


<dt id="arg-adjustment-vars">adjustment_vars<a class="anchor" aria-label="anchor" href="#arg-adjustment-vars"></a></dt>
<dd><p>Optional. Variables to adjust for in the models.</p></dd>


<dt id="arg-model-function">model_function<a class="anchor" aria-label="anchor" href="#arg-model-function"></a></dt>
<dd><p>A function for the model to use (e.g. <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code>,
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code>, survival::coxph()). Can be any model as long as the
function has the arguments <code>formula</code> and <code>data</code>. Type in the model function
as a bare object (without <code>()</code>, for instance as <code>lm</code>).</p></dd>


<dt id="arg-model-arg-list">model_arg_list<a class="anchor" aria-label="anchor" href="#arg-model-arg-list"></a></dt>
<dd><p>Optional. A list containing the named arguments that
will be passed to the model function. A simple example would be
<code>list(family = binomial(link = "logit"))</code> to specify that the <code>glm</code> model
is a logistic model and not a linear one. See the examples for more on the
usage.</p></dd>


<dt id="arg-exponentiate">exponentiate<a class="anchor" aria-label="anchor" href="#arg-exponentiate"></a></dt>
<dd><p>Logical. Whether to exponentiate the log estimates, as
computed with e.g. logistic regression models.</p></dd>


<dt id="arg-classify-option-list">classify_option_list<a class="anchor" aria-label="anchor" href="#arg-classify-option-list"></a></dt>
<dd><p>A list with classification options for direct, ambigious, or no
effects. Used with the <code><a href="classify_options.html">classify_options()</a></code> function with the arguments:</p><ul><li><p><code>single_metabolite_threshold</code>: Default of 0.05. P-values from models with
only the index metabolite (no neighbour adjustment) are classified as effects if
below this threshold. For larger sample sizes and networks, we recommend lowering
the threshold to reduce risk of false positives.</p></li>
<li><p><code>network_threshold</code>: Default of 0.1. P-values from any models that have
direct neighbour adjustments are classified as effects if below this threshold.
This is assumed as a one-sided p-value threshold. Like the threshold above,
a lower value should be used for larger sample sizes and networks.</p></li>
<li><p><code>direct_effect_adjustment</code>: Default is NA. After running the algorithm once,
sometimes it's useful to adjust for the direct effects identified to confirm
whether other links exist.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Outputs a <a href="https://tibble.tidyverse.org/reference/tibble-package.html" class="external-link">tibble</a> that contains the model
estimates from either the exposure or outcome side of the network as well
as the effect classification. Each row represents the "no neighbour node
adjusted" model and has the results for the outcome/exposure to index node
pathway.
Columns for the outcome are:</p><ul><li><p><code>outcome</code> or <code>exposure</code>: The name of the variable used as the external variable.</p></li>
<li><p><code>index_node</code>: The name of the metabolite used as the index node from the network.
In combination with the outcome/exposure variable, they represent the individual
model used for the classification.</p></li>
<li><p><code>estimate</code>: The estimate from the outcome/exposure and index node model.</p></li>
<li><p><code>std_error</code>: The standard error from the outcome/exposure and index node model.</p></li>
<li><p><code>fdr_p_value</code>: The False Discovery Rate-adjusted p-value from the
outcome/exposure and index node model.</p></li>
<li><p><code>effect</code>: The NetCoupler classified effect between the index node and the
outcome/exposure. Effects are classified as "direct" (there is a probable link
based on the given thresholds), "ambigious" (there is a potential link but
not all thresholds were passed), and "none" (no potential link seen).</p></li>
</ul><p>The tibble output also has an attribute that contains all the models
generated <em>before</em> classification. Access it with <code>attr(output, "all_models_df")</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>vignette("examples")</code> article has more
details on how to use NetCoupler with different models.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">standardized_data</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">metabolite_network</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   regressed_on <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="nc_estimate_network.html">nc_estimate_network</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">edge_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_edge_tbl.html">as_edge_tbl</a></span><span class="op">(</span><span class="va">metabolite_network</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">nc_estimate_exposure_links</span><span class="op">(</span></span></span>
<span class="r-in"><span>    edge_tbl <span class="op">=</span> <span class="va">edge_table</span>,</span></span>
<span class="r-in"><span>    exposure <span class="op">=</span> <span class="st">"exposure"</span>,</span></span>
<span class="r-in"><span>    model_function <span class="op">=</span> <span class="va">lm</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 12 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    exposure index_node    estimate std_error fdr_p_value effect   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> exposure metabolite_1   0.173      0.022<span style="text-decoration: underline;">8</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> exposure metabolite_10  0.318      0.021<span style="text-decoration: underline;">9</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> exposure metabolite_11  0.054<span style="text-decoration: underline;">3</span>     0.023<span style="text-decoration: underline;">2</span>      0.040<span style="text-decoration: underline;">9</span> ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> exposure metabolite_12  0.024<span style="text-decoration: underline;">2</span>     0.023<span style="text-decoration: underline;">1</span>      0.380  none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> exposure metabolite_2  -<span style="color: #BB0000;">0.043</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.023<span style="text-decoration: underline;">1</span>      0.106  ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> exposure metabolite_3   0.041<span style="text-decoration: underline;">1</span>     0.023<span style="text-decoration: underline;">1</span>      0.123  ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> exposure metabolite_4   0.003<span style="text-decoration: underline;">44</span>    0.023<span style="text-decoration: underline;">2</span>      0.920  none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> exposure metabolite_5   0.047<span style="text-decoration: underline;">9</span>     0.023<span style="text-decoration: underline;">2</span>      0.071<span style="text-decoration: underline;">7</span> ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> exposure metabolite_6  -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">9</span>     0.023<span style="text-decoration: underline;">0</span>      0.506  none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> exposure metabolite_7  -<span style="color: #BB0000;">0.162</span>      0.022<span style="text-decoration: underline;">9</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> exposure metabolite_8  -<span style="color: #BB0000;">0.355</span>      0.021<span style="text-decoration: underline;">6</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> exposure metabolite_9   0.057<span style="text-decoration: underline;">1</span>     0.023<span style="text-decoration: underline;">0</span>      0.029<span style="text-decoration: underline;">2</span> ambiguous</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get results of all models used prior to classification</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luke Johnston, Clemens Wittenbecher.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute model estimates between an external (exposure or outcome) variable
and a network. — nc_estimate_links • NetCoupler</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute model estimates between an external (exposure or outcome) variable
and a network. — nc_estimate_links"><meta property="og:description" content="
This is the main function that identifies potential links between external factors
and the network. There are two functions to estimate and classify links:
nc_estimate_exposure_links(): Computes the model estimates for the exposure side.
nc_estimate_outcome_links(): Computes the model estimates for the exposure side.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NetCoupler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.4.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/NetCoupler.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/examples.html">Examples of using NetCoupler with different models</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/NetCoupler/NetCoupler/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute model estimates between an external (exposure or outcome) variable
and a network.</h1>
    <small class="dont-index">Source: <a href="https://github.com/NetCoupler/NetCoupler/blob/HEAD/R/estimate-links.R" class="external-link"><code>R/estimate-links.R</code></a></small>
    <div class="hidden name"><code>nc_estimate_links.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>This is the main function that identifies potential links between external factors
and the network. There are two functions to estimate and classify links:</p><ul><li><p><code>nc_estimate_exposure_links()</code>: Computes the model estimates for the exposure side.</p></li>
<li><p><code>nc_estimate_outcome_links()</code>: Computes the model estimates for the exposure side.</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">nc_estimate_exposure_links</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">edge_tbl</span>,
  <span class="va">exposure</span>,
  adjustment_vars <span class="op">=</span> <span class="cn">NA</span>,
  <span class="va">model_function</span>,
  model_arg_list <span class="op">=</span> <span class="cn">NULL</span>,
  exponentiate <span class="op">=</span> <span class="cn">FALSE</span>,
  classify_option_list <span class="op">=</span> <span class="fu"><a href="classify_options.html">classify_options</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">nc_estimate_outcome_links</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">edge_tbl</span>,
  <span class="va">outcome</span>,
  adjustment_vars <span class="op">=</span> <span class="cn">NA</span>,
  <span class="va">model_function</span>,
  model_arg_list <span class="op">=</span> <span class="cn">NULL</span>,
  exponentiate <span class="op">=</span> <span class="cn">FALSE</span>,
  classify_option_list <span class="op">=</span> <span class="fu"><a href="classify_options.html">classify_options</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>The data.frame or tibble that contains the variables of interest,
including the variables used to make the network.</p></dd>
<dt>edge_tbl</dt>
<dd><p>Output graph object from <code><a href="nc_estimate_network.html">nc_estimate_network()</a></code>, converted
to an edge table using <code><a href="as_edge_tbl.html">as_edge_tbl()</a></code>.</p></dd>
<dt>exposure, outcome</dt>
<dd><p>Character. The exposure or outcome variable of interest.</p></dd>
<dt>adjustment_vars</dt>
<dd><p>Optional. Variables to adjust for in the models.</p></dd>
<dt>model_function</dt>
<dd><p>A function for the model to use (e.g. <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code>,
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code>, survival::coxph()). Can be any model as long as the
function has the arguments <code>formula</code> and <code>data</code>. Type in the model function
as a bare object (without <code>()</code>, for instance as <code>lm</code>).</p></dd>
<dt>model_arg_list</dt>
<dd><p>Optional. A list containing the named arguments that
will be passed to the model function. A simple example would be
<code>list(family = binomial(link = "logit"))</code> to specify that the <code>glm</code> model
is a logistic model and not a linear one. See the examples for more on the
usage.</p></dd>
<dt>exponentiate</dt>
<dd><p>Logical. Whether to exponentiate the log estimates, as
computed with e.g. logistic regression models.</p></dd>
<dt>classify_option_list</dt>
<dd><p>A list with classification options for direct, ambigious, or no
effects. Used with the <code><a href="classify_options.html">classify_options()</a></code> function with the arguments:</p><ul><li><p><code>single_metabolite_threshold</code>: Default of 0.05. P-values from models with
only the index metabolite (no neighbour adjustment) are classified as effects if
below this threshold. For larger sample sizes and networks, we recommend lowering
the threshold to reduce risk of false positives.</p></li>
<li><p><code>network_threshold</code>: Default of 0.1. P-values from any models that have
direct neighbour adjustments are classified as effects if below this threshold.
This is assumed as a one-sided p-value threshold. Like the threshold above,
a lower value should be used for larger sample sizes and networks.</p></li>
<li><p><code>direct_effect_adjustment</code>: Default is NA. After running the algorithm once,
sometimes it's useful to adjust for the direct effects identified to confirm
whether other links exist.</p></li>
</ul></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Outputs a <a href="https://tibble.tidyverse.org/reference/tibble-package.html" class="external-link">tibble</a> that contains the model
estimates from either the exposure or outcome side of the network as well
as the effect classification. Each row represents the "no neighbour node
adjusted" model and has the results for the outcome/exposure to index node
pathway.
Columns for the outcome are:</p><ul><li><p><code>outcome</code> or <code>exposure</code>: The name of the variable used as the external variable.</p></li>
<li><p><code>index_node</code>: The name of the metabolite used as the index node from the network.
In combination with the outcome/exposure variable, they represent the individual
model used for the classification.</p></li>
<li><p><code>estimate</code>: The estimate from the outcome/exposure and index node model.</p></li>
<li><p><code>std_error</code>: The standard error from the outcome/exposure and index node model.</p></li>
<li><p><code>fdr_p_value</code>: The False Discovery Rate-adjusted p-value from the
outcome/exposure and index node model.</p></li>
<li><p><code>effect</code>: The NetCoupler classified effect between the index node and the
outcome/exposure. Effects are classified as "direct" (there is a probable link
based on the given thresholds), "ambigious" (there is a potential link but
not all thresholds were passed), and "none" (no potential link seen).</p></li>
</ul><p>The tibble output also has an attribute that contains all the models
generated <em>before</em> classification. Access it with <code>attr(output, "all_models_df")</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="../articles/examples.html">vignette("examples")</a></code> article has more
details on how to use NetCoupler with different models.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span class="va">standardized_data</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">metabolite_network</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="nc_standardize.html">nc_standardize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span>,</span>
<span class="r-in">                   regressed_on <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="nc_estimate_network.html">nc_estimate_network</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"metabolite"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">edge_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_edge_tbl.html">as_edge_tbl</a></span><span class="op">(</span><span class="va">metabolite_network</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">standardized_data</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">nc_estimate_exposure_links</span><span class="op">(</span></span>
<span class="r-in">    edge_tbl <span class="op">=</span> <span class="va">edge_table</span>,</span>
<span class="r-in">    exposure <span class="op">=</span> <span class="st">"exposure"</span>,</span>
<span class="r-in">    model_function <span class="op">=</span> <span class="va">lm</span></span>
<span class="r-in">   <span class="op">)</span></span>
<span class="r-in"><span class="va">results</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 12 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    exposure index_node    estimate std_error fdr_p_value effect   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> exposure metabolite_1   0.173      0.022<span style="text-decoration: underline;">8</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> exposure metabolite_10  0.318      0.021<span style="text-decoration: underline;">9</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> exposure metabolite_11  0.054<span style="text-decoration: underline;">3</span>     0.023<span style="text-decoration: underline;">2</span>      0.040<span style="text-decoration: underline;">9</span> ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> exposure metabolite_12  0.024<span style="text-decoration: underline;">2</span>     0.023<span style="text-decoration: underline;">1</span>      0.380  none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> exposure metabolite_2  -<span style="color: #BB0000;">0.043</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.023<span style="text-decoration: underline;">1</span>      0.106  ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> exposure metabolite_3   0.041<span style="text-decoration: underline;">1</span>     0.023<span style="text-decoration: underline;">1</span>      0.123  ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> exposure metabolite_4   0.003<span style="text-decoration: underline;">44</span>    0.023<span style="text-decoration: underline;">2</span>      0.920  none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> exposure metabolite_5   0.047<span style="text-decoration: underline;">9</span>     0.023<span style="text-decoration: underline;">2</span>      0.071<span style="text-decoration: underline;">7</span> ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> exposure metabolite_6  -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">9</span>     0.023<span style="text-decoration: underline;">0</span>      0.506  none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> exposure metabolite_7  -<span style="color: #BB0000;">0.162</span>      0.022<span style="text-decoration: underline;">9</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> exposure metabolite_8  -<span style="color: #BB0000;">0.355</span>      0.021<span style="text-decoration: underline;">6</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> exposure metabolite_9   0.057<span style="text-decoration: underline;">1</span>     0.023<span style="text-decoration: underline;">0</span>      0.029<span style="text-decoration: underline;">2</span> ambiguous</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Get results of all models used prior to classification</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">results</span>, <span class="st">"all_models_df"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 353 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    exposure index_node   model_id    term  estimate std_error statistic  p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> exposure metabolite_1 fe2b8fdf75… (Int…  0.001<span style="text-decoration: underline;">08</span>    0.021<span style="text-decoration: underline;">9</span>    0.049<span style="text-decoration: underline;">3</span> 9.61<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> exposure metabolite_1 fe2b8fdf75… expo…  0.181      0.022<span style="text-decoration: underline;">1</span>    8.18   5.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> exposure metabolite_1 fe2b8fdf75… meta…  0.275      0.021<span style="text-decoration: underline;">9</span>   12.5    1.35<span style="color: #949494;">e</span><span style="color: #BB0000;">-34</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> exposure metabolite_1 d6e3403a88… (Int…  0.003<span style="text-decoration: underline;">30</span>    0.022<span style="text-decoration: underline;">9</span>    0.144  8.86<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> exposure metabolite_1 d6e3403a88… expo…  0.166      0.024<span style="text-decoration: underline;">3</span>    6.85   9.97<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> exposure metabolite_1 d6e3403a88… meta…  0.019<span style="text-decoration: underline;">5</span>     0.024<span style="text-decoration: underline;">1</span>    0.811  4.18<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> exposure metabolite_1 7dad77d9a9… (Int…  0.002<span style="text-decoration: underline;">60</span>    0.022<span style="text-decoration: underline;">2</span>    0.117  9.07<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> exposure metabolite_1 7dad77d9a9… expo…  0.171      0.022<span style="text-decoration: underline;">5</span>    7.60   4.53<span style="color: #949494;">e</span><span style="color: #BB0000;">-14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> exposure metabolite_1 7dad77d9a9… meta…  0.187      0.022<span style="text-decoration: underline;">3</span>    8.38   1.00<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> exposure metabolite_1 7351d4f8fc… (Int… -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">78</span>    0.022<span style="text-decoration: underline;">3</span>   -<span style="color: #BB0000;">0.125</span>  9.01<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 343 more rows, and 2 more variables: network_neighbours &lt;list&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   adjusted_vars &lt;chr&gt;</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Using a logistic regression</span></span>
<span class="r-in"><span class="va">standardized_data</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">nc_estimate_outcome_links</span><span class="op">(</span></span>
<span class="r-in">    edge_tbl <span class="op">=</span> <span class="va">edge_table</span>,</span>
<span class="r-in">    outcome <span class="op">=</span> <span class="st">"outcome_binary"</span>,</span>
<span class="r-in">    model_function <span class="op">=</span> <span class="va">glm</span>,</span>
<span class="r-in">    adjustment_vars <span class="op">=</span> <span class="st">"age"</span>,</span>
<span class="r-in">    model_arg_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">    exponentiate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 12 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    outcome        index_node    estimate std_error fdr_p_value effect</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> outcome_binary metabolite_1      1.00     <span style="text-decoration: underline;">8</span>172.           1 none  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> outcome_binary metabolite_10     1.00     <span style="text-decoration: underline;">8</span>187.           1 none  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> outcome_binary metabolite_11     1.00     <span style="text-decoration: underline;">8</span>176.           1 none  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> outcome_binary metabolite_12     1.00     <span style="text-decoration: underline;">8</span>172.           1 none  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> outcome_binary metabolite_2      1.00     <span style="text-decoration: underline;">8</span>196.           1 none  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> outcome_binary metabolite_3      1.00     <span style="text-decoration: underline;">8</span>128.           1 none  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> outcome_binary metabolite_4      1.00     <span style="text-decoration: underline;">8</span>206.           1 none  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> outcome_binary metabolite_5      1.00     <span style="text-decoration: underline;">8</span>191.           1 none  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> outcome_binary metabolite_6      1.00     <span style="text-decoration: underline;">8</span>208.           1 none  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> outcome_binary metabolite_7      1.00     <span style="text-decoration: underline;">8</span>248.           1 none  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> outcome_binary metabolite_8      1.00     <span style="text-decoration: underline;">8</span>165.           1 none  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> outcome_binary metabolite_9      1.00     <span style="text-decoration: underline;">8</span>215.           1 none  </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Adding random confounders to adjust for</span></span>
<span class="r-in"><span class="va">standardized_data</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Random <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">         Sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">nc_estimate_exposure_links</span><span class="op">(</span></span>
<span class="r-in">    edge_tbl <span class="op">=</span> <span class="va">edge_table</span>,</span>
<span class="r-in">    exposure <span class="op">=</span> <span class="st">"exposure"</span>,</span>
<span class="r-in">    adjustment_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"Random"</span>, <span class="st">"Sex"</span><span class="op">)</span>,</span>
<span class="r-in">    model_function <span class="op">=</span> <span class="va">lm</span></span>
<span class="r-in">   <span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 12 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    exposure index_node    estimate std_error fdr_p_value effect   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> exposure metabolite_1   0.172      0.023<span style="text-decoration: underline;">0</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> exposure metabolite_10  0.322      0.022<span style="text-decoration: underline;">2</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> exposure metabolite_11  0.054<span style="text-decoration: underline;">2</span>     0.023<span style="text-decoration: underline;">5</span>      0.044<span style="text-decoration: underline;">3</span> ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> exposure metabolite_12  0.029<span style="text-decoration: underline;">0</span>     0.023<span style="text-decoration: underline;">4</span>      0.287  none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> exposure metabolite_2  -<span style="color: #BB0000;">0.046</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.023<span style="text-decoration: underline;">4</span>      0.082<span style="text-decoration: underline;">1</span> ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> exposure metabolite_3   0.043<span style="text-decoration: underline;">2</span>     0.023<span style="text-decoration: underline;">4</span>      0.109  ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> exposure metabolite_4   0.004<span style="text-decoration: underline;">90</span>    0.023<span style="text-decoration: underline;">4</span>      0.878  none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> exposure metabolite_5   0.043<span style="text-decoration: underline;">7</span>     0.023<span style="text-decoration: underline;">5</span>      0.108  ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> exposure metabolite_6  -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">3</span>     0.023<span style="text-decoration: underline;">2</span>      0.514  none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> exposure metabolite_7  -<span style="color: #BB0000;">0.159</span>      0.023<span style="text-decoration: underline;">2</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> exposure metabolite_8  -<span style="color: #BB0000;">0.353</span>      0.021<span style="text-decoration: underline;">8</span>      0      direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> exposure metabolite_9   0.056<span style="text-decoration: underline;">6</span>     0.023<span style="text-decoration: underline;">3</span>      0.033<span style="text-decoration: underline;">3</span> ambiguous</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Adjusting for a previous direct effect</span></span>
<span class="r-in"><span class="va">standardized_data</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">nc_estimate_exposure_links</span><span class="op">(</span></span>
<span class="r-in">    edge_tbl <span class="op">=</span> <span class="va">edge_table</span>,</span>
<span class="r-in">    exposure <span class="op">=</span> <span class="st">"exposure"</span>,</span>
<span class="r-in">    model_function <span class="op">=</span> <span class="va">lm</span>,</span>
<span class="r-in">    adjustment_vars <span class="op">=</span> <span class="st">"age"</span>,</span>
<span class="r-in">    classify_option_list <span class="op">=</span> <span class="fu"><a href="classify_options.html">classify_options</a></span><span class="op">(</span>direct_effect_adjustment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"metabolite_1"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 11 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    exposure index_node    estimate std_error fdr_p_value effect   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> exposure metabolite_10  0.318      0.022<span style="text-decoration: underline;">8</span>    0        direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> exposure metabolite_11  0.051<span style="text-decoration: underline;">8</span>     0.024<span style="text-decoration: underline;">0</span>    0.065<span style="text-decoration: underline;">5</span>   ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> exposure metabolite_12 -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">87</span>    0.023<span style="text-decoration: underline;">5</span>    0.936    none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> exposure metabolite_2  -<span style="color: #BB0000;">0.090</span><span style="color: #BB0000; text-decoration: underline;">9</span>     0.023<span style="text-decoration: underline;">0</span>    0.000<span style="text-decoration: underline;">258</span> direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> exposure metabolite_3   0.024<span style="text-decoration: underline;">4</span>     0.023<span style="text-decoration: underline;">7</span>    0.424    ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> exposure metabolite_4  -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">25</span>    0.024<span style="text-decoration: underline;">0</span>    0.958    none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> exposure metabolite_5   0.043<span style="text-decoration: underline;">7</span>     0.024<span style="text-decoration: underline;">1</span>    0.129    ambiguous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> exposure metabolite_6  -<span style="color: #BB0000;">0.022</span><span style="color: #BB0000; text-decoration: underline;">6</span>     0.023<span style="text-decoration: underline;">9</span>    0.463    none     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> exposure metabolite_7  -<span style="color: #BB0000;">0.166</span>      0.023<span style="text-decoration: underline;">6</span>    0        direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> exposure metabolite_8  -<span style="color: #BB0000;">0.359</span>      0.022<span style="text-decoration: underline;">3</span>    0        direct   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> exposure metabolite_9   0.052<span style="text-decoration: underline;">4</span>     0.023<span style="text-decoration: underline;">7</span>    0.061<span style="text-decoration: underline;">1</span>   ambiguous</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Luke Johnston, Clemens Wittenbecher.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

